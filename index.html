<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PASSCHECK ‚Äî Password Strength Analyzer</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0a0b;
    --surface: #111114;
    --border: #1e1e24;
    --border-bright: #2e2e38;
    --text: #e8e8f0;
    --muted: #5a5a72;
    --accent: #00ff87;
    --accent-dim: rgba(0,255,135,0.08);
    --red: #ff3b5c;
    --red-dim: rgba(255,59,92,0.1);
    --orange: #ff8c42;
    --yellow: #ffd166;
    --green: #00ff87;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'IBM Plex Mono', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 60px 20px 80px;
    background-image:
      radial-gradient(ellipse 80% 50% at 50% -20%, rgba(0,255,135,0.04) 0%, transparent 60%),
      repeating-linear-gradient(0deg, transparent, transparent 39px, rgba(255,255,255,0.015) 39px, rgba(255,255,255,0.015) 40px),
      repeating-linear-gradient(90deg, transparent, transparent 39px, rgba(255,255,255,0.01) 39px, rgba(255,255,255,0.01) 40px);
  }

  .header {
    text-align: center;
    margin-bottom: 48px;
  }

  .logo {
    font-size: 11px;
    letter-spacing: 6px;
    color: var(--accent);
    text-transform: uppercase;
    margin-bottom: 10px;
    opacity: 0.7;
  }

  h1 {
    font-size: clamp(28px, 5vw, 48px);
    font-weight: 700;
    letter-spacing: -1px;
    line-height: 1;
    color: var(--text);
  }

  h1 span { color: var(--accent); }

  .subtitle {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 13px;
    color: var(--muted);
    margin-top: 12px;
    letter-spacing: 0.5px;
  }

  .card {
    width: 100%;
    max-width: 600px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
  }

  .card-header {
    padding: 12px 18px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .dot { width: 8px; height: 8px; border-radius: 50%; }
  .dot-r { background: #ff5f57; }
  .dot-y { background: #febc2e; }
  .dot-g { background: #28c840; }

  .card-title {
    font-size: 10px;
    letter-spacing: 3px;
    color: var(--muted);
    text-transform: uppercase;
    margin-left: 6px;
  }

  .input-wrap {
    padding: 24px;
    position: relative;
  }

  .input-label {
    font-size: 9px;
    letter-spacing: 3px;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 10px;
    display: block;
  }

  .input-row {
    display: flex;
    gap: 0;
    border: 1px solid var(--border-bright);
    transition: border-color 0.2s;
  }
  .input-row:focus-within { border-color: var(--accent); }

  input[type="password"], input[type="text"] {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 16px;
    padding: 14px 16px;
    letter-spacing: 2px;
  }

  input::placeholder { color: var(--muted); letter-spacing: 1px; font-size: 13px; }

  .toggle-btn {
    background: transparent;
    border: none;
    border-left: 1px solid var(--border-bright);
    color: var(--muted);
    cursor: pointer;
    padding: 0 16px;
    font-size: 11px;
    letter-spacing: 1px;
    text-transform: uppercase;
    transition: color 0.2s;
    font-family: 'IBM Plex Mono', monospace;
  }
  .toggle-btn:hover { color: var(--accent); }

  /* Score bar */
  .score-section {
    padding: 0 24px 24px;
  }

  .score-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .score-label {
    font-size: 9px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--muted);
  }

  .score-value {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    transition: color 0.3s;
  }

  .bar-track {
    height: 3px;
    background: var(--border-bright);
    position: relative;
    overflow: visible;
  }

  .bar-fill {
    height: 100%;
    width: 0%;
    transition: width 0.5s cubic-bezier(0.4,0,0.2,1), background 0.3s;
    position: relative;
  }

  .bar-fill::after {
    content: '';
    position: absolute;
    right: -1px;
    top: -3px;
    width: 3px;
    height: 9px;
    background: inherit;
    opacity: 0.6;
    filter: blur(3px);
  }

  /* Divider */
  .divider { border: none; border-top: 1px solid var(--border); }

  /* Metrics grid */
  .metrics {
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-bottom: 1px solid var(--border);
  }

  .metric {
    padding: 16px 24px;
    border-right: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
  }
  .metric:nth-child(even) { border-right: none; }
  .metric:nth-last-child(-n+2) { border-bottom: none; }

  .metric-key {
    font-size: 8px;
    letter-spacing: 2px;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  .metric-val {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
    transition: color 0.3s;
  }

  .check-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    margin-top: 4px;
  }

  .chk { font-size: 10px; }
  .chk.pass { color: var(--green); }
  .chk.fail { color: var(--muted); }

  /* Suggestions */
  .suggestions {
    padding: 20px 24px;
  }

  .section-title {
    font-size: 9px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 14px;
  }

  .suggestion {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 10px 12px;
    background: transparent;
    border-left: 2px solid var(--border-bright);
    margin-bottom: 8px;
    transition: border-color 0.2s, background 0.2s;
    font-size: 11px;
    line-height: 1.6;
    color: var(--muted);
  }

  .suggestion.warn {
    border-left-color: var(--red);
    background: var(--red-dim);
    color: #e0a0a8;
  }

  .suggestion.info {
    border-left-color: var(--yellow);
    background: rgba(255,209,102,0.06);
    color: #c4aa70;
  }

  .suggestion.ok {
    border-left-color: var(--green);
    background: var(--accent-dim);
    color: #70c090;
  }

  .sug-icon { font-size: 14px; line-height: 1; margin-top: 1px; flex-shrink: 0; }

  /* Breach section */
  .breach-section {
    padding: 0 24px 24px;
  }

  .breach-btn {
    width: 100%;
    padding: 12px 20px;
    background: transparent;
    border: 1px solid var(--border-bright);
    color: var(--muted);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 3px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .breach-btn:hover { border-color: var(--accent); color: var(--accent); }
  .breach-btn:disabled { opacity: 0.4; cursor: not-allowed; }

  .breach-result {
    margin-top: 12px;
    padding: 14px 16px;
    font-size: 11px;
    line-height: 1.7;
    display: none;
    border: 1px solid var(--border);
  }

  .breach-result.show { display: block; }
  .breach-result.safe { border-color: var(--green); color: #70c090; background: var(--accent-dim); }
  .breach-result.pwned { border-color: var(--red); color: #e08090; background: var(--red-dim); }
  .breach-result.loading { color: var(--muted); border-color: var(--border); }

  .breach-note {
    font-size: 9px;
    color: var(--muted);
    margin-top: 10px;
    letter-spacing: 0.5px;
    line-height: 1.6;
  }

  /* Entropy display */
  .entropy-bar {
    display: flex;
    gap: 3px;
    margin-top: 4px;
  }
  .entropy-seg {
    flex: 1;
    height: 2px;
    background: var(--border-bright);
    transition: background 0.3s;
  }

  /* Footer */
  .footer {
    margin-top: 32px;
    font-size: 9px;
    color: var(--muted);
    letter-spacing: 2px;
    text-align: center;
    opacity: 0.5;
  }

  /* Animations */
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }
  .cursor { display: inline-block; width: 2px; height: 14px; background: var(--accent); animation: blink 1s step-end infinite; vertical-align: middle; margin-left: 2px; }

  @keyframes fadeIn { from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:translateY(0)} }
  .animate-in { animation: fadeIn 0.3s ease forwards; }

  .empty-state {
    text-align: center;
    padding: 32px 24px;
    color: var(--muted);
    font-size: 11px;
    letter-spacing: 1px;
    border-top: 1px solid var(--border);
  }

  .shield { font-size: 32px; margin-bottom: 12px; opacity: 0.3; }
</style>
</head>
<body>

<header class="header">
  <div class="logo">Security Tool v1.0</div>
  <h1>PASS<span>CHECK</span></h1>
  <p class="subtitle">Real-time password analysis &amp; breach detection</p>
</header>

<div class="card">
  <div class="card-header">
    <div class="dot dot-r"></div>
    <div class="dot dot-y"></div>
    <div class="dot dot-g"></div>
    <span class="card-title">Password Input</span>
  </div>

  <div class="input-wrap">
    <label class="input-label" for="pwd">Enter password to analyze</label>
    <div class="input-row">
      <input type="password" id="pwd" placeholder="Type your password..." autocomplete="off" spellcheck="false">
      <button class="toggle-btn" id="toggleBtn" onclick="toggleVisibility()">Show</button>
    </div>
  </div>

  <div class="score-section">
    <div class="score-row">
      <span class="score-label">Strength Score</span>
      <span class="score-value" id="scoreLabel">‚Äî</span>
    </div>
    <div class="bar-track">
      <div class="bar-fill" id="barFill"></div>
    </div>
  </div>

  <div id="emptyState" class="empty-state">
    <div class="shield">üõ°</div>
    <div>Waiting for input<span class="cursor"></span></div>
  </div>

  <div id="analysis" style="display:none">
    <div class="metrics">
      <div class="metric">
        <div class="metric-key">Length</div>
        <div class="metric-val" id="mLength">‚Äî</div>
      </div>
      <div class="metric">
        <div class="metric-key">Entropy</div>
        <div class="metric-val" id="mEntropy">‚Äî</div>
        <div class="entropy-bar" id="entropyBar"></div>
      </div>
      <div class="metric">
        <div class="metric-key">Charset</div>
        <div class="metric-val" id="mCharset">‚Äî</div>
      </div>
      <div class="metric">
        <div class="metric-key">Checks</div>
        <div id="mChecks"></div>
      </div>
    </div>

    <div class="suggestions" id="suggestionsSection">
      <div class="section-title">Recommendations</div>
      <div id="suggestionsList"></div>
    </div>

    <hr class="divider">

    <div class="breach-section">
      <div class="section-title" style="padding-top:20px">Breach Check</div>
      <button class="breach-btn" id="breachBtn" onclick="checkBreach()">
        <span>üîç</span> Check HaveIBeenPwned Database
      </button>
      <div class="breach-result" id="breachResult"></div>
      <p class="breach-note">‚ö° Uses k-anonymity model ‚Äî your password is never transmitted. Only a 5-char SHA-1 prefix is sent to api.pwnedpasswords.com</p>
    </div>
  </div>
</div>

<div class="footer">PASSCHECK ‚Äî No data stored. No tracking. Fully client-side.</div>

<script>
const COMMON_PASSWORDS = new Set([
  'password','123456','password123','admin','letmein','qwerty','abc123',
  'monkey','master','login','welcome','dragon','pass','1234','12345',
  '1234567890','sunshine','princess','shadow','superman','iloveyou',
  '000000','1111111','12345678','1234567','123456789','pass123','password1'
]);

const pwd = document.getElementById('pwd');
let currentPassword = '';

pwd.addEventListener('input', () => {
  currentPassword = pwd.value;
  analyze(currentPassword);
  // Reset breach result on new input
  document.getElementById('breachResult').className = 'breach-result';
  document.getElementById('breachResult').innerHTML = '';
});

function toggleVisibility() {
  const btn = document.getElementById('toggleBtn');
  if (pwd.type === 'password') {
    pwd.type = 'text';
    btn.textContent = 'Hide';
  } else {
    pwd.type = 'password';
    btn.textContent = 'Show';
  }
}

function calcEntropy(p) {
  let pool = 0;
  if (/[a-z]/.test(p)) pool += 26;
  if (/[A-Z]/.test(p)) pool += 26;
  if (/[0-9]/.test(p)) pool += 10;
  if (/[^a-zA-Z0-9]/.test(p)) pool += 32;
  return pool > 0 ? Math.round(p.length * Math.log2(pool)) : 0;
}

function calcScore(p) {
  if (!p) return 0;
  let score = 0;

  // Length scoring
  if (p.length >= 8) score += 10;
  if (p.length >= 12) score += 10;
  if (p.length >= 16) score += 10;
  if (p.length >= 20) score += 10;

  // Character variety
  if (/[a-z]/.test(p)) score += 5;
  if (/[A-Z]/.test(p)) score += 10;
  if (/[0-9]/.test(p)) score += 10;
  if (/[^a-zA-Z0-9]/.test(p)) score += 15;

  // Multiple special chars
  const specials = (p.match(/[^a-zA-Z0-9]/g) || []).length;
  if (specials >= 2) score += 5;
  if (specials >= 4) score += 5;

  // Entropy bonus
  const entropy = calcEntropy(p);
  if (entropy > 40) score += 5;
  if (entropy > 60) score += 5;
  if (entropy > 80) score += 5;

  // Penalties
  if (COMMON_PASSWORDS.has(p.toLowerCase())) score = Math.min(score, 10);
  if (/^(.)\1+$/.test(p)) score = Math.min(score, 5); // all same char
  if (/^[a-z]+\d{1,4}$/.test(p)) score -= 10; // word + digits pattern
  if (/^[A-Z][a-z]+\d+[^a-zA-Z0-9]?$/.test(p)) score -= 5; // Capital+word+digits

  // Sequential check
  if (/(?:abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/i.test(p)) score -= 10;
  if (/(?:012|123|234|345|456|567|678|789|890)/.test(p)) score -= 10;

  // Keyboard patterns
  if (/qwert|asdf|zxcv|qazwsx/i.test(p)) score -= 10;

  return Math.max(0, Math.min(100, score));
}

function getStrengthLabel(score) {
  if (score < 20) return { label: 'CRITICAL', color: '#ff3b5c' };
  if (score < 40) return { label: 'WEAK', color: '#ff8c42' };
  if (score < 60) return { label: 'FAIR', color: '#ffd166' };
  if (score < 80) return { label: 'STRONG', color: '#00d084' };
  return { label: 'EXCELLENT', color: '#00ff87' };
}

function getSuggestions(p) {
  const s = [];

  if (COMMON_PASSWORDS.has(p.toLowerCase())) {
    s.push({ type: 'warn', icon: '‚õî', text: 'This is one of the most common passwords ‚Äî it will be guessed immediately.' });
  }

  if (p.length < 8) {
    s.push({ type: 'warn', icon: 'üìè', text: `Too short (${p.length} chars). Minimum 8 characters required. Aim for 16+.` });
  } else if (p.length < 12) {
    s.push({ type: 'info', icon: 'üìè', text: `Length is okay but 16+ characters provides much stronger protection.` });
  } else if (p.length >= 16) {
    s.push({ type: 'ok', icon: '‚úì', text: 'Good length ‚Äî longer passwords are exponentially harder to crack.' });
  }

  if (!/[A-Z]/.test(p)) s.push({ type: 'info', icon: 'üî°', text: 'Add uppercase letters (A‚ÄìZ) to expand the character space.' });
  if (!/[0-9]/.test(p)) s.push({ type: 'info', icon: 'üî¢', text: 'Include numbers (0‚Äì9) to strengthen the password.' });
  if (!/[^a-zA-Z0-9]/.test(p)) {
    s.push({ type: 'info', icon: '‚ú≥Ô∏è', text: 'Add special characters (!@#$%^&*) for a much larger key space.' });
  } else if ((p.match(/[^a-zA-Z0-9]/g) || []).length >= 2) {
    s.push({ type: 'ok', icon: '‚úì', text: 'Multiple special characters ‚Äî well done.' });
  }

  if (/^(.)\1+$/.test(p)) s.push({ type: 'warn', icon: '‚ö†Ô∏è', text: 'Password is all repeated characters ‚Äî essentially zero entropy.' });

  if (/qwert|asdf|zxcv|qazwsx/i.test(p)) s.push({ type: 'warn', icon: '‚å®Ô∏è', text: 'Contains keyboard pattern (qwerty, asdf‚Ä¶) ‚Äî easily guessed.' });

  if (/(?:012|123|234|345|456|567|678|789)/.test(p)) s.push({ type: 'warn', icon: 'üî¢', text: 'Sequential number pattern detected ‚Äî avoid 123, 456, etc.' });

  if (/(?:abc|bcd|cde|efg|fgh|ghi|hij|klm|lmn|mno|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/i.test(p)) {
    s.push({ type: 'warn', icon: 'üî°', text: 'Sequential letter pattern detected (abc, xyz‚Ä¶) ‚Äî easily guessed.' });
  }

  const entropy = calcEntropy(p);
  if (entropy >= 80) s.push({ type: 'ok', icon: '‚ö°', text: `High entropy (${entropy} bits) ‚Äî excellent randomness.` });

  if (s.length === 0) s.push({ type: 'ok', icon: '‚úì', text: 'No major weaknesses detected. Consider checking against breach databases.' });

  return s;
}

function analyze(p) {
  const emptyState = document.getElementById('emptyState');
  const analysis = document.getElementById('analysis');

  if (!p) {
    emptyState.style.display = 'block';
    analysis.style.display = 'none';
    document.getElementById('barFill').style.width = '0%';
    document.getElementById('scoreLabel').textContent = '‚Äî';
    document.getElementById('scoreLabel').style.color = '';
    return;
  }

  emptyState.style.display = 'none';
  analysis.style.display = 'block';

  const score = calcScore(p);
  const { label, color } = getStrengthLabel(score);
  const entropy = calcEntropy(p);

  // Score bar
  const bar = document.getElementById('barFill');
  bar.style.width = score + '%';
  bar.style.background = color;

  const scoreLabel = document.getElementById('scoreLabel');
  scoreLabel.textContent = `${label}  (${score}/100)`;
  scoreLabel.style.color = color;

  // Metrics
  document.getElementById('mLength').textContent = p.length;
  document.getElementById('mLength').style.color = p.length >= 12 ? 'var(--green)' : p.length >= 8 ? 'var(--yellow)' : 'var(--red)';

  document.getElementById('mEntropy').textContent = entropy + ' bits';
  document.getElementById('mEntropy').style.color = entropy >= 80 ? 'var(--green)' : entropy >= 50 ? 'var(--yellow)' : 'var(--red)';

  // Entropy bar (10 segments)
  const eBar = document.getElementById('entropyBar');
  const segs = Math.min(10, Math.round(entropy / 12.8));
  eBar.innerHTML = '';
  for (let i = 0; i < 10; i++) {
    const seg = document.createElement('div');
    seg.className = 'entropy-seg';
    if (i < segs) seg.style.background = color;
    eBar.appendChild(seg);
  }

  // Charset
  let charsetSize = 0;
  if (/[a-z]/.test(p)) charsetSize += 26;
  if (/[A-Z]/.test(p)) charsetSize += 26;
  if (/[0-9]/.test(p)) charsetSize += 10;
  if (/[^a-zA-Z0-9]/.test(p)) charsetSize += 32;
  document.getElementById('mCharset').textContent = charsetSize;

  // Checks
  const checks = [
    { label: 'Uppercase', pass: /[A-Z]/.test(p) },
    { label: 'Numbers', pass: /[0-9]/.test(p) },
    { label: 'Symbols', pass: /[^a-zA-Z0-9]/.test(p) },
    { label: '12+ chars', pass: p.length >= 12 },
  ];
  document.getElementById('mChecks').innerHTML = checks.map(c =>
    `<div class="check-row"><span class="chk ${c.pass ? 'pass' : 'fail'}">${c.pass ? '‚úì' : '‚óã'}</span><span style="font-size:9px;color:${c.pass ? 'var(--text)' : 'var(--muted)'};letter-spacing:0.5px">${c.label}</span></div>`
  ).join('');

  // Suggestions
  const suggestions = getSuggestions(p);
  document.getElementById('suggestionsList').innerHTML = suggestions.map(s =>
    `<div class="suggestion ${s.type} animate-in"><span class="sug-icon">${s.icon}</span><span>${s.text}</span></div>`
  ).join('');
}

async function checkBreach() {
  const p = currentPassword;
  if (!p) return;

  const btn = document.getElementById('breachBtn');
  const result = document.getElementById('breachResult');

  btn.disabled = true;
  result.className = 'breach-result loading show';
  result.innerHTML = '‚è≥ Computing SHA-1 hash and checking database...';

  try {
    // SHA-1 via Web Crypto
    const encoder = new TextEncoder();
    const data = encoder.encode(p);
    const hashBuffer = await crypto.subtle.digest('SHA-1', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();

    const prefix = hashHex.slice(0, 5);
    const suffix = hashHex.slice(5);

    const response = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`, {
      headers: { 'Add-Padding': 'true' }
    });

    if (!response.ok) throw new Error('API error');

    const text = await response.text();
    const lines = text.split('\n');
    let count = 0;

    for (const line of lines) {
      const [hashSuffix, countStr] = line.split(':');
      if (hashSuffix.trim() === suffix) {
        count = parseInt(countStr.trim(), 10);
        break;
      }
    }

    if (count > 0) {
      result.className = 'breach-result pwned show';
      result.innerHTML = `üö® <strong>BREACHED!</strong> This password appears <strong>${count.toLocaleString()}</strong> time${count === 1 ? '' : 's'} in known data breaches.<br><br>‚ö† You should <strong>never use this password</strong> anywhere. Change it immediately if currently in use.`;
    } else {
      result.className = 'breach-result safe show';
      result.innerHTML = `‚úÖ <strong>NOT FOUND</strong> in the HaveIBeenPwned database.<br><br>This password hasn't appeared in known breach datasets. However, this doesn't guarantee it's safe to use ‚Äî also check the strength score above.`;
    }
  } catch (err) {
    result.className = 'breach-result show';
    result.style.color = 'var(--orange)';
    result.style.borderColor = 'var(--orange)';
    result.innerHTML = `‚ö† Could not reach HIBP API. Check your connection.<br><small style="opacity:0.6">${err.message}</small>`;
  }

  btn.disabled = false;
}
</script>
</body>
</html>
